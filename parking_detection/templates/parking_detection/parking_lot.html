{% extends "parking_detection/base.html" %}
{% load static %}

{% block title %}
	Spot
{% endblock %}

{% block head %}
	<style>
		/* GLOBAL STYLES */
		
		/* CUSTOMIZE THE CAROUSEL */

		#copyright {
			font-size: 12px;
		}

		#social_handle > a:hover {
			text-decoration: none;
			color: black;
			font-size: 18px;
		}

		.grey-text {
			color: grey;
		}

		.dark-grey-text {
			color: #2e2e2e
		}

		#navbar {
			background-color: rgba(220, 53, 69, 1);
		}

		#brand {
			margin-right: 60px;
			margin-left: 50px;
		}

		#home {
			color: white;
		}

		#home:hover {
			text-decoration: none;
			color: black;
		}

		.map-img {
			width: 60%;
			height: 60%;
			float: right;
			z-index: 0px;
		}

		#title {
			padding-top: 90px;
			padding-bottom: 10px;
		}

		.checkbox {
			position: fixed;
			padding-left: 20px;
		}

		.wrapper {
		    position:relative;
		    z-index: 0px;
		}

		#box1 {
		    position:absolute;
		    top:120px;
		    left:575px;
		    width:50px;
		    height:150px;
		    border:2px solid green;
		    background-color:transparent;
		    z-index: 10px;
		}

		#box2 {
		    position:absolute;
		    top:120px;
		    left:710px;
		    width:50px;
		    height:150px;
		    border:2px solid green;
		    background-color:transparent;
		    z-index: 10px;
		}

		#box3 {
		    position:absolute;
		    top:120px;
		    left:775px;
		    width:50px;
		    height:150px;
		    border:2px solid red;
		    background-color:transparent;
		    z-index: 10px;
		}

		#box4 {
		    position:absolute;
		    top:120px;
		    left:905px;
		    width:50px;
		    height:150px;
		    border:2px solid red;
		    background-color:transparent;
		    z-index: 10px;
		}

		.zone-label {
			transform: rotate(-90deg);
			padding-top: 60px;
			padding-bottom: 60px;
			color: white;

			/* TODO: Fix position relative to image when window size is changed; */
		}

	</style>
{% endblock %}

{% block body %}

	<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
	<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

	{% include "parking_detection/navbar.html" %}

	<div id='title' class="container"><h1>Harris Commons</h1></div>

	<div class="container">
		<h3 style="position: fixed">Filters</h3>
		<div class="checkbox" style="padding-top: 50px">
		  <label>
		    <input type="checkbox" checked data-toggle="toggle">
		    Option one is enabled
		  </label>
		</div>
		<div class="checkbox" style="padding-top: 100px">
		  <label>
		    <input type="checkbox" checked data-toggle="toggle">
		    Option two is enabled
		  </label>
		</div>
		<div class="wrapper">
			<img class ='map-img' src="{% static 'parking_detection/images/L3HarrisCommons_map.png' %}" alt="L3 Harris Commons Map" />
			<div id="box1"><div id='l1' class='zone-label'>SPOTS AVAILABLE</div></div>
			<div id="box2"><div id='l2' class='zone-label'>SPOTS AVAILABLE</div></div>
			<div id="box3"><div id='l3' class='zone-label'>SPOTS AVAILABLE</div></div>
			<div id="box4"><div id='l4' class='zone-label'>SPOTS AVAILABLE</div></div>
		</div>
	</div>

	<div class="demo" style="padding-top: 100px">
		  <span id="demo"></span>
	</div>

	<script>
	// Every 1 second -> updateClock
	// setInterval(updateClock, 1000);

	// function updateClock() {
	//   const d = new Date();
	//   document.getElementById("demo").innerHTML = d.toLocaleTimeString();
	// }

	//Every 5 Minutes -> updateMap
	setInterval(updateMap, 1000);

	function updateMap() {
		fetch("/map-data", {method: "PUT"})
			.then(response => response.json())
			.then(data => {
				var l1 = data.zone1;
				var l2 = data.zone2;
				var l3 = data.zone3;
				var l4 = data.zone4;

				console.log(data);

				if (l1 == 0) {
					document.getElementById("l1").innerHTML = "NONE AVAILABLE";
					document.getElementById("box1").style.border = "2px solid red" 
				} else {
					document.getElementById("l1").innerHTML = "SPOTS AVAILABLE";
					document.getElementById("box1").style.border = "2px solid green" 
				}

				if (l2 == 0) {
					document.getElementById("l2").innerHTML = "NONE AVAILABLE";
					document.getElementById("box2").style.border = "2px solid red"

				} else {
					document.getElementById("l2").innerHTML = "SPOTS AVAILABLE";
					document.getElementById("box2").style.border = "2px solid green"
				}

				if (l3 == 0) {
					document.getElementById("l3").innerHTML = "NONE AVAILABLE";
					document.getElementById("box3").style.border = "2px solid red"
				} else {
					document.getElementById("l3").innerHTML = "SPOTS AVAILABLE";
					document.getElementById("box3").style.border = "2px solid green" 
				}

				if (l4 == 0) {
					document.getElementById("l4").innerHTML = "NONE AVAILABLE";
					document.getElementById("box4").style.border = "2px solid red"
				} else {
					document.getElementById("l4").innerHTML = "SPOTS AVAILABLE";
					document.getElementById("box4").style.border = "2px solid green" 
				}
			});
	}

	</script>

{% endblock %}